DROP SCHEMA IF EXISTS SERVICE;
CREATE SCHEMA SERVICE;
SET SCHEMA_SEARCH_PATH SERVICE;

CREATE TABLE PRODUCT
(
  id            BIGINT GENERATED BY DEFAULT AS IDENTITY,
  name          VARCHAR(255) NOT NULL UNIQUE,
  last_modified TIMESTAMP DEFAULT NOW(),
  version       INTEGER   DEFAULT 0,
  PRIMARY KEY (ID)
);

CREATE TABLE CATEGORY
(
  id            BIGINT GENERATED BY DEFAULT AS IDENTITY,
  name          VARCHAR(255) NOT NULL UNIQUE,
  last_modified TIMESTAMP DEFAULT NOW(),
  version       INTEGER   DEFAULT 0,
  PRIMARY KEY (id)
);

CREATE TABLE PRODUCT_CATEGORIES
(
  product_id  BIGINT NOT NULL,
  category_id BIGINT NOT NULL,
  PRIMARY KEY (product_id, category_id),
  FOREIGN KEY (product_id) REFERENCES PRODUCT (id),
  FOREIGN KEY (category_id) REFERENCES CATEGORY (id)
);